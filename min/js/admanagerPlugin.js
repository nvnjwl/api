SPL.plugins.adManager=function(json,config,player,containerID,currentPlayerObj){var S=SPL.conf;var t=this;t.pluginName="adManager";t.name="adManager";t.containerID=containerID;t.player=player;t.conf=config.playerVars;t.id="adManager";t.eventOccured={"loaded":false,"start":true};t.libraryLoaded=false;t.initreceived=false;var Loader=player.loader;console.log("dev11 :: Loader is ",Loader);console.log("dev11 :: Player  is ",player);console.log("dev11 :: player.loader  is ",player.loader);t._={pl:null,isBusy:false,current:null,isPostRoll:false,isPostRoll:false,tmr:null};t._ad={};t.prepared=false;window.adsPlayed=window.adsPlayed||[];this.adsPlayed=[];t._.data={adtype:'pre',duration:0,adId:0,position:0,event:0,state:'error'};t.adEventDispatchedList=[];t.adSingleEventList=["init","ready","initload","manifest"];t.adRetryDefault=1;t.adRetryCount=t.adRetryDefault;t.canErrorSend=true;t.uniqueAdID;t.isDispatchedAgain=function(eventName){if(t.isOneTimeEvent()){if(t.eventDispatchedList.indexOf(eventName)==-1){return true;}else{return false;}}else{return true;}};t.isOneTimeEvent=function(eventName){if(t.singleEventList.indexOf(eventName)!=-1){return true;}else{return false;}};t.createADControls=function(containerID){console.log('containerID is ',containerID);var adContainer=UTIL.createDiv("","spl_A spl_FS spl_z3 spl_H",containerID);adContainer.setAttribute("style","height: 100%;width: 100%");t._ad.adContainer=adContainer;console.log("mobilead player",currentPlayerObj.videoElem,player.videoElem);t._ad.imaVideo=currentPlayerObj.videoElem;console.log("click event mobile imavideo ",currentPlayerObj.videoElem.paused)
var div1=UTIL.createDiv("","spl_A spl_aTxt spl_Ft spl_c spl_z1",adContainer,"Advertisment");var aContainer=UTIL.createDiv("","spl_aContainer spl_A spl_FS",adContainer);t._ad.aContainer=aContainer;var buttonDiv=UTIL.createDiv("","spl_A spl_bl _spl_bottom",adContainer);t.buttons=buttonDiv;var Pbutton=UTIL.createDiv("","spl_ch spl_l spl_fl spl_z1 spl_ico spl_shd",buttonDiv,"");Pbutton.setAttribute("data-title","Pause");var Vbutton=UTIL.createDiv("","spl_ch spl_l spl_fl spl_z1 spl_ico spl_shd",buttonDiv,"");Vbutton.setAttribute("data-title","Mute");t._ad.Volume=Vbutton;t._ad.PlayButton=Pbutton;var seekbar=UTIL.createDiv("","spl_A spl_Fb _spl_seekbar",adContainer);t.seekbar=seekbar;console.log("creating seekbar 1 width="+_els(seekbar,'width'));_els(seekbar,'width','0%');seekbar.setAttribute("style","border: 2px solid yellow;");t._ad.seekbar=seekbar;console.log("creating seekbar 2 width="+_els(t._ad.seekbar,'width'));}
t.onPlayerEvent=function(et,data){var onpe={init:function(){t.initreceived=true;t.player=this;if(!SPL.isMobile){t._.isPreRoll=true;console.log('dev11 Check if came here');PlayAdWrapper(0);}else{console.log("admanager mobile");}},ready:function(){console.log("admanager event ready volume = "+SPL.localSettings.mute);},start:function(){Loader.hide();console.log("admanager event start volume = "+SPL.localSettings.mute);if(t._.isPreRoll===true){console.log("admanager event start volume = "+SPL.localSettings.mute);}},manifest:function(){},position:function(p){if(_mf(p.position)>_mf(t.tc)){console.log('dev04 admanager Event at position :: '+_mf(p.position)+" tc:: "+_mf(t.tc));}else{}t.tc=_mr(p.position);},complete:function(){PlayAd(-1);}};onpe[et]&&onpe[et].apply(this,[data]);};var motAnalytics;var isMoatEnabled=false;function initMoatTracking(c,d,e,k,l){var g=document.createElement("script"),a=[];d={adData:{ids:d,duration:e,url:l},dispatchEvent:function(b){this.sendEvent?(a&&(a.push(b),b=a,a=!1),this.sendEvent(b)):a.push(b)}};e="_moatApi"+Math.floor(1E8*Math.random());var f,h;try{f=c.ownerDocument,h=f.defaultView||f.parentWindow}catch(b){f=document,h=window}h[e]=d;g.type="text/javascript";c&&c.insertBefore(g,c.childNodes[0]||null);g.src="https://z.moatads.com/"+k+"/moatvideo.js#"+e;return d;}function moatDispatchEvents(adobj){try{if(isMoatEnabled){_le("Sending moat data..."+adobj.type);motAnalytics.dispatchEvent(adobj);}}catch(e){}}function initMoat(ad,vidCont){if(!isMoatEnabled){_le("MOAT is not enabled.");return;}if(typeof ad=='undefined'||typeof vidCont=='undefined'){_le("MOAT was found but due to some issue this is disabled for now.");return;}var id={};var arr=ad.getTitle().split("|");id.level1=arr.length<=1?'':arr[arr.length-1];id.level2=ad.getAdId();id.level3=ad.getAdId();id.level4=ad.getCreativeId();id.slicer1='';id.slicer2="";motAnalytics=initMoatTracking(vidCont,id,ad.getDuration(),"timesofindiaslikejsvideo152964269350",window.parent.document.location.href);}var _playWhenReady=null;function PlayAdWrapper(tc){if(t.libraryLoaded&&t.initreceived){console.log("Wait completed , t.libraryLoaded ::"+t.libraryLoaded+" ,t.initreceived :: "+t.initreceived);PlayAd(tc);}else{console.log("..wait , t.libraryLoaded ::"+t.libraryLoaded+" ,t.initreceived :: "+t.initreceived);}}function PlayAd(tc){console.log("dev11 PLAY AD called tc ="+tc);t.timeCode=tc;if(!t.prepared&&_playWhenReady===null){_playWhenReady=tc;return;}console.log("PLAY AD 1");if(json.ads.campaign===undefined){return;}console.log("dev31 PLAY AD 2 for containerID :: "+t.containerID,Loader);Loader.hide();var ai=-1,i=0,ctc=-10;for(;i<json.ads.timecode.length;i++){ctc=json.ads.timecode[i];if(((ctc==-1&&tc==-1)||(ctc>=0&&ctc<=tc))&&window.adsPlayed.indexOf(ctc)===-1){ai=i;break;}}console.log("PLAY AD 3 for containerID :: "+t.containerID);if(ai!==-1&&window.adsPlayed.indexOf(_mr(tc))===-1){t._.isPostRoll=tc===-1?true:false;var c=json.ads.campaign[ai];t.currentAdlength=c.length;console.log("currentAdlength :: "+t.currentAdlength,c);t._.current=c[0];console.log("dev11 PLAY AD 5 if for containerID :: "+t.containerID,c,t._.current.url);t.requestAds(t._.current.url);}else{t._.isPostRoll=tc===-1?true:false;window.adsPlayed[window.adsPlayed.length]=ctc;var c=json.ads.campaign[ai];t._.current=c[0];console.log("PLAY AD 6 else for containerID :: "+t.containerID+"because ai :: "+ai+"window.adsPlayed.indexOf(_mr(tc)) :: "+window.adsPlayed.indexOf(_mr(tc)));if(typeof config.adconf!='undefined'){t._.current.url=replacePairs(t._.current.url,config.adconf);}t.requestAds(t._.current.url);}}var ad=null;t.onAdEvents=function(e){if(typeof t.player=='undefined')return;if(typeof e=='undefined')return;if(e==null)return;console.log('ad event occur :: '+e.type);ad=e.getAd();if(typeof ad=='undefined'){t.onAdError(null);return;}if(ad==null){t.onAdError(null);return;}console.log("t.onAdEvents = "+e.type+" "+SPL.checkIsOnline());t.adsState=e.type;if(e.type==="loaded"){var str=ad.getTitle();str=typeof str=='undefined'?"":str;if(str.indexOf("MOAT|")!==-1){isMoatEnabled=true;initMoat(ad,_el('html5'));}else isMoatEnabled=false;if(!ad.isLinear()){this.player&&this.player.play();}}else{if(isMoatEnabled){_le("MOAT is enabled...sending data now.");if(e.type==="start")moatDispatchEvents({"type":"AdVideoStart","adVolume":t.AM.getVolume()});else if(e.type==="firstquartile")moatDispatchEvents({"type":"AdVideoFirstQuartile","adVolume":t.AM.getVolume()});else if(e.type==="midpoint")moatDispatchEvents({"type":"AdVideoMidpoint","adVolume":t.AM.getVolume()});else if(e.type==="thirdquartile")moatDispatchEvents({"type":"AdVideoThirdQuartile","adVolume":t.AM.getVolume()});else if(e.type==="complete")moatDispatchEvents({"type":"AdVideoComplete","adVolume":t.AM.getVolume()});else if(e.type==="playing")moatDispatchEvents({"type":"AdPlaying","adVolume":t.AM.getVolume()});else if(e.type==="paused")moatDispatchEvents({"type":"AdPaused","adVolume":t.AM.getVolume()});else if(e.type==="volumeChange")moatDispatchEvents({"type":"AdVolumeChange","adVolume":t.AM.getVolume()});else if(e.type==="skip")moatDispatchEvents({"type":"AdStopped","adVolume":t.AM.getVolume()});}}var evtdata={click:[9,'click'],complete:[7,'complete'],firstquartile:[4,'Q1'],loaded:[0,'loaded'],midpoint:[5,'Q2'],start:[1,'start'],thirdquartile:[6,'Q3'],skip:[8,'skip'],pause:[10,'PAUSED'],resume:[11,'RESUME']};var adDuration=typeof ad.getDuration()=='undefined'?0:ad.getDuration();t._.data={adtype:(!t.player||!!t.player.position===false||t._.isPreRoll===true||!!t.player.isLive()===true)?'pre':(_mf(t.player.position)===_mf(t.player.duration)?'post':'mid'),duration:adDuration,adId:typeof ad.getAdId()=='undefined'?"":ad.getAdId(),campaignId:t._.current.id,source:t._.source,muted:t.player.isMute,paused:(evtdata[[e.type]]&&evtdata[[e.type]][0]===10)?true:false,position:_f(adDuration)-_f(t.AM.getRemainingTime()),event:evtdata[[e.type]]?evtdata[[e.type]][0]:null,isQueueable:true,state:evtdata[[e.type]]?evtdata[[e.type]][1]:null};console.log('ad event occur with Data :: ',t._.data);var onae={allAdsCompleted:function(){_ld("allAdsCompleted:::");},start:function(){Loader.hide();clearTimeout(t._.tmr);controls.onstart();t.eventOccured.start=true;t.hideControls();setTimeout(function(){t.on3seconds();},3000);},resume:function(){controls.play();console.log("adevent1 onae playing")},pause:function(){controls.pause();console.log("adevent1 onae paused")}};onae[e.type]&&onae[e.type].call(this);t.eventOccured.loaded=true;t._.data.state&&t.player&&t.player.onAdevent(_JSF(t._.data));if(t._.data.state==='complete'||t._.data.state==='skip'){clearInterval(controls.tmr);setTimeout(controls.onend,30);}};t.hideControls=function(){if(SPL.browserName=="Mobile Safari"){_elemAddClass(t.contentPlayer,"spl_z5");_elemAddClass(t.buttons,"spl_H");_elemAddClass(t.seekbar,"spl_H");}};t.requestAds=function(adTagUrl){t.canErrorSend=true;console.log("dev29 requestAds PLAY AD 4 for containerID :: "+t.containerID+"and url ::"+adTagUrl);json.adsTimeout=_mr(json.adsTimeout)>=4000?json.adsTimeout:10000;if(t._.tmr!=null){clearTimeout(t._.tmr);t._.tmr=null;}t._.tmr=setTimeout(t.onTimeout,json.adsTimeout);var iu=_gup("iu",adTagUrl);iu=extractIU(iu);t._.data={adtype:(t._.isPreRoll===true)?'pre':((_mr(t.tc)==-1||t._.isPostRoll===true)?'post':'mid'),duration:0,adId:0,campaignId:t._.current.id,source:t._.source,muted:t.player&&t.player.isMute,paused:null,position:0,event:0,iudata:iu,isQueueable:true,state:'request'};console.log("post ad t._.data.adtype="+t._.data.adtype+" _mr(t.tc)="+_mr(t.tc));t.player.timeadrequest=new Date();t._.isBusy=true;Loader.show();console.log("Play Ad google.ima.AdsRequest");t.aR=new google.ima.AdsRequest();console.log("Play Ad google.ima.AdsRequest t.aR:",t.aR);if(typeof t.conf.pid==='undefined')t.conf.pid="";if(t.conf.pid==='null')t.conf.pid="";if(typeof t.conf.sg==='undefined')t.conf.sg="";if(t.conf.sg==='null')t.conf.sg="";var sg=(t.conf.sg!=""&&t.conf.sg.indexOf("sg=")==-1)?"&sg="+t.conf.sg:"&"+t.conf.sg;sg=encodeURIComponent(sg);var section=t.conf.pagesection==""?"_":t.conf.pagesection;section=getSF(section);var cust_params="pid%3D"+(t.conf.pid==""?"_":t.conf.pid)+"%26section%3D"+section;var vendor="_";try{if(typeof json!=='undefined'&&typeof json.vendor!=='undefined')vendor=json.vendor;}catch(e){}cust_params+="%26vendor%3D"+vendor;cust_params+=sg;var cp=adTagUrl.match(/(cust_params=[^&]*)/ig);if(cp==null)adTagUrl+="&cust_params="+cust_params;else{adTagUrl=adTagUrl.replace(cp,"");cp+="%26"+cust_params;adTagUrl+="&"+cp;}var hardCodeAd1="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dskippablelinear&correlator=";var hardCodeAd2="https://pubads.g.doubleclick.net/gampad/ads?sz=420x315&iu=%2F7176%2FTOI%2FTOI_ROS_Videos%2FTOI_ROS_Videos_Videoshow&gdfp_req=1&env=vp&output=xml_vast3&unviewed_position_start=1&url=http%3A%2F%2Ftimesofindia.indiatimes.com&description_url=%5Bdescription_url%5D&correlator=3306940590160652&cust_params=pid%3D%26section%3DNews%2CNews_Videos%26vendor%3D3&sdkv=h.3.175.0&sdki=3c0d&scor=4052635744845769&adk=146183766&osd=2&frm=2&sdr=1&ged=ve4_td3_tt2_pd3_la3000_er0.0.0.0_vi0.0.415.569_vp0_eb16747";var nonSkipAd10Sec="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dlinear&correlator=";var skip10sec="https://pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dskippablelinear&correlator=";var nonLinear="https://pubads.g.doubleclick.net/gampad/ads?sz=480x70&iu=/124319096/external/single_ad_samples&ciu_szs=300x250&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&cust_params=deployment%3Ddevsite%26sample_ct%3Dnonlinear&correlator=";t.aR.adTagUrl=adTagUrl;console.log("adTagUrls ("+t.tc+") :: "+t.aR.adTagUrl);t.aR.linearAdSlotWidth="100%";t.aR.linearAdSlotHeight="100%";location.hash='!/tc/'+_mr(_f(this.tc));t.player&&t.player.onAdevent(_JSF(t._.data));t.adsLoader.requestAds(t.aR);};t.onTimeout=function(){t._.isBusy=false;controls.onend();};t.isUserActionCaptured=false;t.onUserAction=function(e){if(t.isUserActionCaptured)return;t.isUserActionCaptured=true;t.initialUserAction(e);try{if(SPL.UA.getOS().name=='iOS'){}}catch(e){}};t.oninit=function(){console.log("PLAY AD t.oninit");t.isReady=true;t.prepare();};this.onPrepared=function(){console.log("PLAY AD onPrepared");t.libraryLoaded=true;t.prepared=true;t._.data.state='ready';t.player&&t.player.onAdevent(_JSF(t._.data));if(_playWhenReady!==null&&!SPL.isMobile){PlayAd(_playWhenReady);}else{PlayAdWrapper(0);}controls.init();};this.prepare=function(){console.log("PLAY AD prepare for playerIndex :: "+currentPlayerObj.playerIndex);this.Container=_el(t._ad.aContainer);this.contentPlayer=_el(t._ad.imaVideo);console.log("t._ad.Container  = ",this.Container);console.log("t._ad.contentPlayer = ",this.contentPlayer,currentPlayerObj.videoElem);google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);this.adDisplayContainer=new google.ima.AdDisplayContainer(t.Container,t.contentPlayer);this.adsLoader=new google.ima.AdsLoader(t.adDisplayContainer);this.adsLoader.addEventListener('adsManagerLoaded',t.onAdsManagerLoaded,false,t);this.adsLoader.addEventListener('adError',t.onAdError,false,t);this.onPrepared();};t.onAdsManagerLoaded=function(admle){var s=new google.ima.AdsRenderingSettings();s.restoreCustomPlaybackStateOnAdBreakComplete=false;s.bitrate=600;s.enablePreloading=true;s.useStyledLinearAds=true;s.useStyledNonLinearAds=true;s.autoAlign=true;t.AM=admle.getAdsManager(t.contentPlayer,s);t.processAdsManager(t.AM);};t.processAdsManager=function(){if(t.AM.isCustomClickTrackingUsed()){t.customClickDiv_.style.display='table';}try{if(t.conf.settings.volume!=0){console.log("t.conf.settings.volume = "+t.conf.settings.volume,t.AM)
t.AM.setVolume(t.conf.settings.volume/100);}}catch(e){}t.AM.addEventListener("contentPauseRequested",t.onContentPauseRequested,false,t);t.AM.addEventListener("contentResumeRequested",t.onContentResumeRequested,false,t);t.AM.addEventListener('adError',t.onAdError,false,t);var events=["allAdsCompleted","click","complete","firstquartile","loaded","midpoint","pause","start","thirdquartile","skip","volumeChange",'resume'];for(var index in events){t.AM.addEventListener(events[index],t.onAdEvents,false,t);}t.AM.init("100%","100%",google.ima.ViewMode.NORMAL);t.AM.start();};t.AdErrorTimer=null;t.onAdError=function(adErrorEvent){console.log('0 retry dev29 adError with t.adRetryCount :: '+getCurTime()+" "+t.adRetryCount,adErrorEvent);clearTimeout(t.AdErrorTimer);t.AdErrorTimer=null;t.AdErrorTimer=setTimeout(function(adErrorEvent){console.log("dev29 adError in Timeout");handleAdError(t,adErrorEvent);},500,adErrorEvent);function canRetry(){var retVal=false;if(t.eventOccured.loaded||t.eventOccured.start){retVal=false;}else{retVal=true;}console.log("canRetry :: "+retVal+t.eventOccured.loaded+t.eventOccured.start);return retVal;}function handleAdError(t,adErrorEvent){console.log('1 retry dev29 adError with t.adRetryCount :: '+getCurTime()+" "+t.adRetryCount,adErrorEvent);var isRetry=t.adRetryCount;if(isRetry>0&&isRetry<t.currentAdlength&&canRetry()){console.log('retry 3 with adFailover becasue isRetry :: '+isRetry);t.adFailover();}else{console.log('Do not retry with adFailover isRetry:'+isRetry+",t.currentAdlength:"+t.currentAdlength);Loader.hide();clearTimeout(t._.tmr);clearInterval(this.tmr);if(this.AM){this.AM.destroy();}var curadType;if(_mr(t.tc)<=1||t._.isPreRoll===true){curadType="pre";}else if(_mr(t.tc)==-1||t._.isPostRoll===true){curadType="post";}else{curadType="mid";}t._.data={adtype:(t._.isPreRoll===true)?'pre':((_mr(t.tc)==-1||t._.isPostRoll===true)?'post':'mid'),duration:0,adId:0,campaignId:t._.current.id,source:t._.source,muted:t.player&&t.player.isMute,paused:null,position:0,event:0,state:'error',isQueueable:true,errorcode:adErrorEvent.getError()['h']};if(t._.isPreRoll===true){t._.isPreRoll=false;}var errorObj={module:"admanager",message:t._.data.errorcode,code:"9000",type:"critical"}
SPL.error.log(errorObj);if(t.player){console.log("retry 2",t._.data);t.player&&t.player.onAdevent(_JSF(t._.data));}console.log("retry 1 with isRetry :: "+t.adRetryCount);setTimeout(controls.onend,100);}}}
var controls={vol:0.1,tmr:null,muted:false,paused:false,progress:function(){var du=t.AM.getCurrentAd().getDuration(),p=du-_f(t.AM.getRemainingTime());if(du==undefined)return;var origWidth=_els(t._ad.seekbar,'width');if(p!=NaN&&p!=undefined&&du!=NaN&&du!=undefined&&origWidth!=false){_els(t._ad.seekbar,'width',(p/du)*100+'%');var prevWidth=(p/du)*100;var tmr=setTimeout(function(prevWidth1){var currWidth=(p/du)*100;if(currWidth==prevWidth1){}else{}},10000,prevWidth);}else{console.log("controls.progress 2");_els(t._ad.seekbar,'width','0%');}},onstart:function(){if(t.player&&t.player.isMute){controls.volume(0);}else if(t.player&&!t.player.isMute&&t.player.volume()!==0){console.log("volume ad elseif:: "+t.player.volume());controls.volume(t.player.volume()/100);}Loader.hide();_elemRemoveClass(t._ad.adContainer,'spl_H');console.log("dev01 adplaypause:: ",t.conf);var isADControls=false;t.conf.controls.adplaypause=isADControls;if(t.conf.controls.adplaypause!==undefined&&t.conf.controls.adplaypause===false){_elemRemoveClass(t._ad.PlayButton,'spl_H');}else{}controls.tmr=setInterval(controls.progress,125);},onend:function(){_elemAddClass(t._ad.adContainer,'spl_H');t.onend();clearInterval(controls.tmr);},init:function(v){_elemListenersAttach(t._ad.PlayButton,'click',controls.pp);_elemListenersAttach(t._ad.Volume,'click',controls.volumeToggle);},mute:function(){_elsa(t._ad.Volume,"data-title","Unmute");SPL.setLocalSettings({mute:true});t.AM.setVolume(0);controls.muted=true;t.player.mute();},unmute:function(){_elsa(t._ad.Volume,"data-title","Mute");t.AM.setVolume(t.player.volume()/100);_elemRemoveClass(t._ad.Volume,'fcr');controls.muted=false;t.player.unmute();SPL.setLocalSettings({mute:false});},volumeToggle:function(v){var volumeState=_elsa(t._ad.Volume,"data-title");if(volumeState=="Mute"){controls.mute();}else if(volumeState=="Unmute"){controls.unmute();}},volume:function(e){if(e==0){controls.mute();}else{var defaultMute=false;try{t.conf&&t.conf.offline.volume&&(defaultMute=SPL.localSettings.mute);if(defaultMute==undefined){defaultMute=false;}}catch(err){defaultMute=false;}var isPlayerMute=defaultMute;var isPlayerVolume=t.player.volume();if(t.AM&&isPlayerMute==true){controls.mute();}else if(t.AM&&isPlayerVolume>0&&isPlayerMute==false){controls.unmute();}}},pause:function(){console.log('control.pause triggered');controls.paused=true;var adEventName="";var adEventType="VERBOSE";var adEventData=t._.data;adEventName="pause";console.log("check if controls.paused ::"+controls.paused);t.AM.pause();t._ad.PlayButton.setAttribute("data-title","Play");t.sendEvent(adEventName,adEventType,adEventData);},play:function(){controls.paused=false;var adEventName="";var adEventType="VERBOSE";var adEventData=t._.data;adEventName="play";console.log("check if controls.paused ::"+controls.paused);t.AM.resume();t._ad.PlayButton.setAttribute("data-title","Pause");t.sendEvent(adEventName,adEventType,adEventData);},pp:function(){var ppState=_elsa(t._ad.PlayButton,"data-title");console.log("controlsPP  ::"+ppState);if(ppState=="Play"){controls.play();}else if(ppState=="Pause"){controls.pause();}},updatePP:function(){}};t.bootstrap=function(){if(true||player.getControlsName()=='web'||player.getControlsName()=='native'){console.log('Ad controls will create');t.createADControls(containerID);}try{!window.google&&this.load();}catch(err){console.log("PLAY AD window.google 1 "+err.message+" containerID is :: "+containerID);}try{window.google&&google.ima&&this.oninit();}catch(err){console.log("PLAY AD window.google 2 "+err.message+" containerID is :: "+containerID);}}
this.destroy=function(splayerCbfn){console.log('destroy called on admanager plugin');if(this.AM!=undefined&&this.AM!=null){this.AM.destroy();}currentPlayerObj.eventManagerObj.unsubscribe('adManager');splayerCbfn();}
t.sendEvent=function(eventName,eventType,eventData){currentPlayerObj.eventManagerObj.dispatchEvent(eventName,eventType,eventData);}
t.play=function(){console.log('dev09 Ad Play Requested from Adplugin');controls.play();};t.pause=function(){console.log('ad data Ad Pause Requested from Adplugin');controls.pause();};t.isPlaying=function(){console.log('dev09 check if Ad is Playing or paused ::'+controls.paused);return!controls.paused;};t.isPaused=function(){console.log('dev09 check if Ad is Playing or paused ::'+controls.paused);return controls.paused;};t.curIndexPre=0;t.curIndexPost=0;t.curIndexMid=0;t.adFailover=function(){console.log('dev29 try for Ad Failover');var c;var preTC=0;var postTC=-1;var midTC=1500;var adType="";var tc=t.timeCode;t._.isPostRoll=tc===-1?true:false;if(tc==-1){adType="post";}else if(tc==0){adType="pre";}else{adType="mid";}switch(adType){case"pre":c=json.ads.campaign[preTC];t.curIndexPre++;if(c.length>t.curIndexPre){t._.current=c[t.curIndexPre];failoverSuccess(adType);}else{failoverError(adType);}break;case"post":c=json.ads.campaign[postTC];t.curIndexPost++;if(c.length>t.curIndexPost){t._.current=c[t.curIndexPost];failoverSuccess(adType);}else{failoverError(adType);}break;case"mid":c=json.ads.campaign[midTC];t.curIndexMid++;if(c.length>t.curIndexMid){t._.current=c[t.curIndexMid];failoverSuccess(adType);}else{failoverError(adType);}break;}function failoverSuccess(adType){console.log("failoverSuccess for AdType :: "+adType);json.adsTimeout=_mr(json.adsTimeout)>=8000?json.adsTimeout:8000;if(t._.tmr!=null){clearTimeout(t._.tmr);t._.tmr=null;}t._.tmr=setTimeout(t.onTimeout,json.adsTimeout);t._.data={adtype:(_mr(t.tc)<1||t._.isPreRoll===true)?'pre':(_mr(t.tc)==-1?'post':'mid'),duration:0,adId:0,campaignId:t._.current.id,muted:t.player&&t.player.isMute,paused:null,position:0,event:0,state:'request'};t.player&&t.player.onAdevent(_JSF(t._.data));t._.isBusy=true;Loader.show();if(t.aR==null||t.aR==undefined){t.aR=new google.ima.AdsRequest();}t.aR.adTagUrl=t._.current.url;t.aR.linearAdSlotWidth="100%";t.aR.linearAdSlotHeight="100%";location.hash='!/tc/'+_mr(_f(this.tc));t.adsLoader.requestAds(t.aR);t.adRetryCount--;}function failoverError(adType){console.log("failoverSuccess for AdType :: "+adType);Loader.hide();clearTimeout(t._.tmr);clearInterval(this.tmr);var curadType;if(_mr(t.tc)<=1||t._.isPreRoll===true){curadType="pre";}else if(_mr(t.tc)==-1||t._.isPostRoll===true){curadType="post";}else{curadType="mid";}t._.data={adtype:curadType,duration:0,adId:0,campaignId:t._.current.id,muted:t.player&&t.player.isMute,paused:null,position:0,event:0,state:'error',errorcode:adErrorEvent.g.h+"||"+adErrorEvent.g.l+"||"+adErrorEvent.g.o};if(t._.isPreRoll===true){t._.isPreRoll=false;}if(t.player){t.player.onAdevent(_JSF(t._.data));}setTimeout(controls.onend,10);}};}
SPL.plugins.adManager.prototype={onContentPauseRequested:function(){this.player&&this.player.pause();},onContentResumeRequested:function(){console.log('dev11 onContentResumeRequested called from Ad try play now');console.log('dev11 paramas::',this._.isPostRoll,this.player);!this._.isPostRoll&&this.player&&setTimeout(this.player.play,100);},onend:function(){var t=this;_elemRemoveClass(t.contentPlayer,"spl_z5");console.log("retry onend function "+t.adRetryCount);t.adRetryCount=t.adRetryDefault;this._.isBusy=false;if(this.AM){console.log("Destroying admanager");this.AM.destroy();}if(this._.isPreRoll===true){this._.isPreRoll=false;}clearTimeout(this._.tmr);clearInterval(this.tmr);this._.isBusy=false;this._.data.state='ended';console.trace("retry onend send");this.player&&this.player.onAdevent(_JSF(t._.data));this._.isPostRoll&&this.player&&this.player._.dispatch('ended');},on3seconds:function(){var t=this;var _data={position:3,state:'3seconds'};this.player&&this.player.onAdevent(_JSF(_data));},load:function(){this._.data.state='load';this.player&&this.player.onAdevent(_JSF(this._.data));console.log(" initialUserAction getting sdkURL Now for containerID :: "+this.containerID+" URL :: "+SPL.conf.imaSDKUrl);loadJs(SPL.conf.imaSDKUrl,this.oninit);},initialUserAction:function(){console.log("initialUserAction ad");this.adDisplayContainer&&this.adDisplayContainer.initialize();this.contentPlayer&&this.contentPlayer.load();},volume:function(e){console.log('Ad volume Requested');},setVolume:function(){console.log('Ad setVolume Requested');},toggleVolume:function(){console.log('Ad toggleVolume Requested');},mute:function(){console.log('Ad mute Requested');},unmute:function(){console.log('Ad unmute Requested');},isMute:function(){return false;}}