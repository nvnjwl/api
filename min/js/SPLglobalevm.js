SPL.global={};SPL.global.EventManager=(function(){var evm={};evm.broadcastList=["PLAYING","play","pause","state","volume","start"];evm.isAllowed=function(name){if(evm.broadcastList.indexOf(name)>-1)return true;else{return false;}}
evm.convert={PLAYING:"PAUSE","volume":"VOLUME","pause":"PAUSE","play":"PAUSE"}
evm.onPlayerEvent=function(eventName,eventType,eventData,currentPlayerObj){if(eventName=='_adstate'){switch(eventData.state){case'load':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'ready':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'request':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'loaded':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'start':currentPlayerObj.setActiveElement(currentPlayerObj.adManagerObj);evm.broadcast('start',eventType,eventData,currentPlayerObj);break;case'play':evm.broadcast('play',eventType,eventData,currentPlayerObj);break;case'pause':break;case'Q1':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'Q2':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'Q3':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'complete':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'skip':console.log('================  ADEVENT occur [GLOBAL] ========= with state ',eventData.state);break;case'ended':currentPlayerObj.setActiveElement(currentPlayerObj.curPlayer);break;default:console.log('================  ADEVENT occur========= with state ',eventData.state);}}else if(eventName!="_adstate"){evm.broadcast(eventName,eventType,eventData,currentPlayerObj);}};evm.isSendEvent=function(currentPlayerObj,i){if(SPL.allPlayerList[i]==null||SPL.allPlayerList[i]==undefined){return false;}else if(currentPlayerObj.playerIndex==SPL.allPlayerList[i].playerIndex||currentPlayerObj.containerID==SPL.allPlayerList[i].containerID){return false;}else{return true;}}
evm.convert=function(name,type,data){var commandName;switch(name){case"_adstate":if(data.state=="play"){commandName="PAUSE";}else if(data.state=="start"){commandName="PAUSE";}break;case"playing":case"PLAYING":commandName="PAUSE";break;case"play":commandName="PAUSE";break;case"pause":commandName="PAUSE123";break;case"volume":commandName="VOLUME";break;case"start":commandName="PAUSE";break;default:commandName="DEFAULT";}switch(data){case"playing":case"PLAYING":commandName="PAUSE";break;case"play":case"Play":commandName="PAUSE";break;}return commandName;};evm.broadcast=function(name,type,data,currentPlayerObj){var curEMObj;var isPaused;if(evm.isAllowed(data)||evm.isAllowed(name)){var commandName=evm.convert(name,type,data);switch(commandName){case"VOLUME":if(data.mute){console.log("Gevm mute1 to allplayer");evm.muteAllPlayers();}else{console.log("Gevm volume to allplayer");evm.sendVolume(data.volume);}break;case"MUTE":console.log("Gevm mute to allplayer");evm.muteAllPlayers();break;case"PAUSE":console.log("adplaypause Event PAUSE CAME");for(var i=0;i<SPL.allPlayerList.length;i++){if(evm.isSendEvent(currentPlayerObj,i)){console.log("Global Sending commands to playerindex :: "+SPL.allPlayerList[i].playerIndex);isPaused=evm.isActiveElementPaused(SPL.allPlayerList[i]);if(!isPaused){console.log("adplaypauseBC2 if isPaused :: "+isPaused+" at player :: "+i);curEMObj=SPL.allPlayerList[i].eventManagerObj;setTimeout(function(){curEMObj.receiveEvent(name,type,data,commandName,currentPlayerObj.getActiveElement());},0,name,type,data);}else{console.log("adplaypauseBC2 else isPaused :: "+isPaused+" at player :: "+i);curEMObj=SPL.allPlayerList[i].eventManagerObj;}}else{}}break;default:console.log("command Name :: "+commandName);break;}}};evm.pauseAllPlayers=function(){for(var i=0;i<SPL.allPlayerList.length;i++){if(SPL.allPlayerList[i].curPlayer==undefined){console.log("No player return");return;}isPaused=SPL.isMobile?SPL.allPlayerList[i].curPlayer.isPaused:evm.isActiveElementPaused(SPL.allPlayerList[i]);console.log("globalevmevm pauseAllPlayers isPaused = "+isPaused+" "+SPL.allPlayerList[i].curPlayer.isPaused)
if(SPL.allPlayerList[i].controlsBaseObj&&SPL.allPlayerList[i].controlsBaseObj.hideQualityMenu){SPL.allPlayerList[i].controlsBaseObj.hideQualityMenu();}if(!isPaused){console.log("tab ["+i+"] isPaused :: "+isPaused);SPL.allPlayerList[i].systemPause=true;curEMObj=SPL.allPlayerList[i].eventManagerObj;console.log("tab currentActiveElement index :: "+SPL.allPlayerList[i].playerIndex);setTimeout(function(curEMObj_copy){curEMObj_copy.receiveEvent("","","","PAUSE","");},0,curEMObj);}else{console.log("tab ["+i+"] isPaused :: "+isPaused);SPL.allPlayerList[i].systemPause=false;curEMObj=SPL.allPlayerList[i].eventManagerObj;console.log("tab currentActiveElement index :: "+SPL.allPlayerList[i].playerIndex);}}}
evm.resumeAllPlayers=function(){for(var i=0;i<SPL.allPlayerList.length;i++){wasPlayed=SPL.allPlayerList[i].systemPause;if(SPL.allPlayerList[i].controlsBaseObj&&SPL.allPlayerList[i].controlsBaseObj.hideQualityMenu){SPL.allPlayerList[i].controlsBaseObj.hideQualityMenu();}if(wasPlayed){SPL.allPlayerList[i].systemPause=false;curEMObj=SPL.allPlayerList[i].eventManagerObj;setTimeout(function(){curEMObj.receiveEvent("","","","PLAY","DOCUMENT_RESUME");},0);}else{console.log("Do nothing");}}}
evm.sendCommand=function(commandName){}
evm.muteAllPlayers=function(){}
evm.sendVolume=function(data){}
evm.isActiveElementPaused=function(_currentPlayerObj){var currentActiveElement=_currentPlayerObj.getActiveElement();if(currentActiveElement.pluginName=="adManager"){var isPlaying=currentActiveElement.isPlaying();console.log('DEBUG14 ADmanger isPlaying :: '+isPlaying);return!isPlaying;}else{return currentActiveElement.videoElem&&currentActiveElement.videoElem.paused;}};evm.hideQualityClick=function(){document.addEventListener('click',function(e){for(var i=0;i<SPL.allPlayerList.length;i++){var curControls=SPL.allPlayerList[i].controlsBaseObj;if(curControls==null||e.target==curControls.settingsMenuOuter||e.target==curControls.settingsIconClick||curControls.settingsMenuOuter==null||curControls.settingsMenuOuter==undefined){return;}var elem=curControls.settingsMenuOuter;var elemL=_elr(elem).left;var elemR=_elr(elem).right;var elemT=_elr(elem).top;var elemB=_elr(elem).bottom;var evtX=e.clientX;var evtY=e.clientY;var isInside=true;if(evtX>elemL&&evtX<elemR&&evtY>elemT&&evtY<elemB){isInside=true;}else{isInside=false;}if(!isInside){curControls&&curControls.hideQualityMenu&&curControls.hideQualityMenu();}else{}}},true);}
return evm;})();